<!DOCTYPE html>
<html lang="zh-tw"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <title>學習筆記</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="練習專案一：復刻兩百個國家、兩百年、四分鐘">
  <meta name="author" content="Steve">
    
  
  <meta name="theme-name" content="liva-hugo" />
  
  <meta name="generator" content="Hugo 0.140.2">

  <!-- plugins -->
  
  <link rel="stylesheet" href="http://localhost:1313/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="http://localhost:1313/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="http://localhost:1313/plugins/themify-icons/themify-icons.css ">
  
  <link rel="stylesheet" href="http://localhost:1313/plugins/venobox/venobox.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="http://localhost:1313/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="http://localhost:1313/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="http://localhost:1313/images/favicon.png " type="image/x-icon">

  <!-- google analitycs -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'Your ID', 'auto');
    ga('send', 'pageview');
  </script>

</head>
<body><!-- navigation -->
<header class="navigation sticky"> 
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0">
      <a class="navbar-brand mobile-view" href="http://localhost:1313/"><img class="img-fluid"
          src="http://localhost:1313/images/favicon1.png" alt="學習筆記"></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        
        
        
        <a class="navbar-brand mx-auto desktop-view" href="http://localhost:1313/"><img class="img-fluid"
          src="http://localhost:1313/images/favicon1.png" alt="學習筆記">
        </a>

        <ul class="navbar-nav">
          
          
          <li class="nav-item">
            <a class="nav-link" href="http://localhost:1313/about/">About</a>
          </li>
          
          
          
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">
              筆記
            </a>
            <div class="dropdown-menu">
              
              <a class="dropdown-item" href="http://localhost:1313/note/hugo">hugo 網站建置</a>
              
              <a class="dropdown-item" href="http://localhost:1313/note/data_analysis">數據分析</a>
              
            </div>
          </li>
          
          
        </ul>

        
        <!-- search -->
        <div class="search pl-lg-4">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="http://localhost:1313//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="Type & Hit Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        

        
      </div>
    </nav>
  </div>
</header>
<!-- /navigation -->

<section class="section-sm">
  <div class="container">
    <div class="row">
      <div class="col-lg-10 mx-auto">
        
        <a href="/categories/data-analysis"
          class="text-primary">Data analysis</a>
        
        <h2>練習專案一：復刻兩百個國家、兩百年、四分鐘</h2>  
        <div class="mb-3 post-meta">
          <span>By Steve</span>
          
          <span class="border-bottom border-primary px-2 mx-1"></span>
          <span>2025-02-07</span> 
          
        </div>
        
        <div class="content mb-5">
          <br>
<h4 id="復刻目標hans-roslings-200-countries-200-years-4-minuteshttpsyoutubejbksrlysojosi5wkjooiu_ipukgsr">復刻目標：<a href="https://youtu.be/jbkSRLYSojo?si=5WkjOoiU_IPuKGsR">Hans Rosling&rsquo;s 200 Countries, 200 Years, 4 Minutes</a></h4>
<p>專案說明：描述了隨人均GDP上升，各國的平均壽命也在不斷提升。<br>
如何復刻 Hans Rosling&rsquo;s 200 Countries, 200 Years, 4 Minutes<br></p>
<ul>
<li>資料需求。
<ul>
<li>X 軸：    人均 GDP</li>
<li>Y 軸：    預期壽命。</li>
<li>顏色：    洲別。</li>
<li>氣泡大小：人口數。</li>
<li>時間軸：  年份。</li>
</ul>
</li>
<li>視覺化需求。
<ul>
<li>概念驗證：matplotlib</li>
<li>成品：plotly.express</li>
</ul>
</li>
</ul>
<div class="border-bottom"></div><br> 
<h4 id="資料">資料</h4>
<ul>
<li>人均GDP：ddf&ndash;datapoints&ndash;gdp_pcap&ndash;by&ndash;country&ndash;time</li>
<li>預期壽命：ddf&ndash;datapoints&ndash;lex&ndash;by&ndash;country&ndash;time</li>
<li>洲別：ddf&ndash;datapoints&ndash;pop&ndash;by&ndash;country&ndash;time</li>
<li>人口數：ddf&ndash;entities&ndash;geo&ndash;country</li>
<li>資料來源：Gapminder 提供，主要用於描述和分析全球的社會、經濟、環境等多方面統計數據。
<ul>
<li>Systema Globalis</li>
<li><a href="https://github.com/open-numbers/ddf--gapminder--fasttrack">Fast Track</a> &lt;- 這次使用的資料</li>
<li>World Development Indicators
<br></li>
</ul>
</li>
</ul>
<img src=/images/note/data_analysis/project_1/Gapminder資料介紹.jpg>
<div class="border-bottom"></div><br>
<h4 id="sql-plotting資料表名對照">SQL plotting資料表名對照</h4>
<ul>
<li>country_name     :國家名稱</li>
<li>continent        :洲別</li>
<li>dt_yaer          :年</li>
<li>gdp_per_capita   :平均GDP</li>
<li>life_expectancy  :平均壽命</li>
<li>population       :人口數
<br></li>
</ul>
<p>虛擬資料表</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#ff79c6">CREATE</span> <span style="color:#ff79c6">VIEW</span> plotting <span style="color:#ff79c6">AS</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> <span style="color:#ff79c6">g</span>.name <span style="color:#ff79c6">AS</span> country_name, 
</span></span><span style="display:flex;"><span>       <span style="color:#ff79c6">g</span>.world_4region <span style="color:#ff79c6">AS</span> continent,
</span></span><span style="display:flex;"><span>       gpc.time <span style="color:#ff79c6">as</span> dt_yaer,
</span></span><span style="display:flex;"><span>       gpc.gdp_pcap <span style="color:#ff79c6">AS</span> gdp_per_capita,
</span></span><span style="display:flex;"><span>       le.lex <span style="color:#ff79c6">AS</span> life_expectancy,
</span></span><span style="display:flex;"><span>       p.pop <span style="color:#ff79c6">AS</span> population
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">FROM</span> gdp_per_capita gpc 
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">JOIN</span> geography <span style="color:#ff79c6">g</span> 
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">ON</span> <span style="color:#ff79c6">g</span>.country <span style="color:#ff79c6">=</span> gpc.country 
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">JOIN</span> life_expectancy le 
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">ON</span> le.country <span style="color:#ff79c6">=</span> gpc.country <span style="color:#ff79c6">AND</span> 
</span></span><span style="display:flex;"><span>      le.time  <span style="color:#ff79c6">=</span> gpc.time 
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">JOIN</span> population p 
</span></span><span style="display:flex;"><span>   <span style="color:#ff79c6">ON</span> p.country <span style="color:#ff79c6">=</span> gpc.country <span style="color:#ff79c6">AND</span> 
</span></span><span style="display:flex;"><span>      p.time <span style="color:#ff79c6">=</span> gpc.time 
</span></span><span style="display:flex;"><span> <span style="color:#ff79c6">WHERE</span> gpc.time <span style="color:#ff79c6">&lt;</span> <span style="color:#bd93f9">2024</span>;
</span></span></code></pre></div><div class="border-bottom"></div><br>
<h4 id="創建環境">創建環境</h4>
<h5 id="conda">Conda</h5>
<br>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>conda create -n gapminder_clone <span style="color:#8be9fd;font-style:italic">python</span><span style="color:#ff79c6">=</span>3.12
</span></span><span style="display:flex;"><span>conda install pandas
</span></span><span style="display:flex;"><span>conda install matplotlib
</span></span></code></pre></div><div class="border-bottom"></div><br>
<h4 id="matplotlib">matplotlib</h4>
<br>
<p>ani.save()出現錯誤</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt;&gt;&gt; ani.save<span style="color:#ff79c6">(</span><span style="color:#f1fa8c">&#34;animation.gif&#34;</span>, <span style="color:#8be9fd;font-style:italic">fps</span><span style="color:#ff79c6">=</span>10<span style="color:#ff79c6">)</span>
</span></span><span style="display:flex;"><span>MovieWriter ffmpeg unavailable; using Pillow instead.
</span></span></code></pre></div><p>解決方法:安裝 ffmpeg <br></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>conda install ffmpeg
</span></span></code></pre></div><p>參考資料:https://blog.csdn.net/weixin_50569998/article/details/108811466</p>
<div class="border-bottom"></div><br>
<h4 id="成品">成品</h4>
<br>
<ul>
<li>使用 plotly.express 來完成</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>px<span style="color:#ff79c6">.</span>scatter(
</span></span><span style="display:flex;"><span>    df,                               <span style="color:#6272a4"># 數據來源的 DataFrame</span>
</span></span><span style="display:flex;"><span>    x<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;gdp_per_capita&#34;</span>,               <span style="color:#6272a4"># 設定 x 軸數據（人均 GDP）</span>
</span></span><span style="display:flex;"><span>    y<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;life_expectancy&#34;</span>,              <span style="color:#6272a4"># 設定 y 軸數據（平均壽命）</span>
</span></span><span style="display:flex;"><span>    animation_frame<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;dt_year&#34;</span>,        <span style="color:#6272a4"># 設定動畫的時間維度（年份）</span>
</span></span><span style="display:flex;"><span>    animation_group<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;country_name&#34;</span>,   <span style="color:#6272a4"># 指定動畫中不同國家的數據追蹤</span>
</span></span><span style="display:flex;"><span>    size<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;population&#34;</span>,                <span style="color:#6272a4"># 設定氣泡大小對應人口數量</span>
</span></span><span style="display:flex;"><span>    color<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;continent&#34;</span>,                <span style="color:#6272a4"># 以洲別來區分顏色</span>
</span></span><span style="display:flex;"><span>    hover_name<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;country_name&#34;</span>,        <span style="color:#6272a4"># 滑鼠懸停時顯示國家名稱</span>
</span></span><span style="display:flex;"><span>    size_max<span style="color:#ff79c6">=</span><span style="color:#bd93f9">100</span>,                     <span style="color:#6272a4"># 設定氣泡的最大大小</span>
</span></span><span style="display:flex;"><span>    range_x<span style="color:#ff79c6">=</span>[<span style="color:#bd93f9">500</span>, <span style="color:#bd93f9">100000</span>],            <span style="color:#6272a4"># 設定 x 軸的範圍（GDP 人均值範圍）</span>
</span></span><span style="display:flex;"><span>    range_y<span style="color:#ff79c6">=</span>[<span style="color:#bd93f9">20</span>, <span style="color:#bd93f9">90</span>],                 <span style="color:#6272a4"># 設定 y 軸的範圍（預期壽命範圍）</span>
</span></span><span style="display:flex;"><span>    log_x<span style="color:#ff79c6">=</span><span style="color:#ff79c6">True</span>,                       <span style="color:#6272a4"># 使 x 軸（GDP）以對數尺度顯示</span>
</span></span><span style="display:flex;"><span>    title<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;Gapminder Clone 1800-2023&#34;</span> <span style="color:#6272a4"># 設定圖表標題</span>
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><ul>
<li>成品：上傳Github後就可以呈現了</li>
</ul>
<iframe src="https://ho291ey992.github.io/gapminder_clone/gapminder_clone.html" width="800" height="600"  width=90% ></iframe>
<br>
<ul>
<li>成品：使用 Power BI 來完成。
<ul>
<li>為了達成 X 軸刻度顯示比較明顯， <strong>&ldquo;log_x=True&rdquo;</strong> 的效果 PowerBI 使用 <strong>&ldquo;對數刻度&rdquo;</strong> 來呈現。 <br></li>
</ul>
</li>
</ul>
<blockquote>
<p>注意：Power BI 只支援 正數 轉換為對數，因此數據不能包含 0 或負數，否則會導致錯誤，所以 X 軸最小值要設定大於1才能使用 。</p>
</blockquote>
<img src="/images/note/data_analysis/project_1/project_1_powerbi.png">
<br>
<div class="border-bottom"></div><br>
<h4 id="markdown-嵌入html檔安全性">Markdown 嵌入html檔安全性</h4>
<h5 id="vs-code-預覽無法顯示網頁">VS Code 預覽無法顯示網頁。</h5>
<ul>
<li>
<p>原因：預設任何外部資源，開頭必須是 https，如果是 http，則在文件預覽的時候，將會無法顯示。
<br></p>
</li>
<li>
<p>如果想要調整，步驟如下：</p>
<ul>
<li>按下 F1。</li>
<li>輸入 &gt;markdown change preview security setting。</li>
<li>選擇符合自己需求的選項。</li>
<li>security</li>
</ul>
</li>
</ul>
<div class="border-bottom"></div><br>
<h4 id="建立environmentyml">建立environment.yml</h4>
<h5 id="目的重現專案環境用">目的：重現專案環境用</h5>
<br>
<ul>
<li>
<p>課堂上預設是conda-forge，但是我在安裝未指定<strong>下載頻道</strong>所以這裡改為預設。</p>
<pre tabindex="0"><code>name: gapminder_clone
channels:
  - Default Channels:默認頻道  
dependencies:
  - python=3.12.8
  - pandas=2.2.3 
  - matplotlib=3.9.2 
  - plotly=5.24.1 
</code></pre><ul>
<li>
<p>這邊使用conda list | findstr $module_name (windows Anaconda Prompt)
<img src="/images/note/data_analysis/project_1/conda_list_findstr.png"></p>
</li>
<li>
<p>conda install numpy</p>
<ul>
<li>不指定頻道，會使用 Conda 的 默認頻道（Default Channels）。</li>
<li>默認頻道的套件通常是由 Anaconda 官方維護，穩定性較高，但更新速度可能較慢。</li>
</ul>
</li>
<li>
<p>conda install -c conda-forge numpy</p>
<ul>
<li>明確指定從 conda-forge 頻道安裝套件。</li>
<li>這個方式會直接從 conda-forge 獲取 numpy 模組。
<br></li>
</ul>
</li>
</ul>
</li>
<li>
<p>conda內建environment.yml產生方法：conda env export &gt; [檔案名稱.yml]</p>
<ul>
<li>相較於課堂上教學的更為完整</li>
<li>若無設定路徑為<strong>命令字元當下目錄</strong>，有需要也可以指定位置。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>conda env <span style="color:#8be9fd;font-style:italic">export</span> &gt; environment.yml
</span></span><span style="display:flex;"><span>conda env <span style="color:#8be9fd;font-style:italic">export</span> &gt; C:<span style="color:#f1fa8c">\U</span>sers<span style="color:#f1fa8c">\S</span>teve<span style="color:#f1fa8c">\a</span>naconda3<span style="color:#f1fa8c">\e</span>nvs<span style="color:#f1fa8c">\a</span>naconda_practise_myenv<span style="color:#f1fa8c">\e</span>nvironment.yml
</span></span></code></pre></div></li>
</ul>
<div class="border-bottom"></div><br>
<h4 id="撰寫-readmemd">撰寫 README.md</h4>
<h5 id="如何重現">如何重現</h5>
<ul>
<li>安裝 Miniconda</li>
<li>依據 environment.yml 建立環境：conda env create -f environment.yml</li>
<li>將 data/ 資料夾中的四個 CSV 檔案置放於工作目錄中的 data/ 資料夾。</li>
<li>啟動環境並執行 python create_gapminder_db.py 就能在 data/ 資料夾中建立 gapminder.db</li>
<li>啟動環境並執行 python plot_with_px.py 就能生成 gapminder_clone.html</li>
</ul>
<div class="border-bottom"></div><br>
<h4 id="github">Github</h4>
<ul>
<li>新增一個 Repository，.gitignore 選 Python，授權不選或者選 MIT/BSD License</li>
<li>手動將專案資料夾中的檔案與資料夾（必須要用拖移無法用選取）上傳。</li>
<li>Settings -&gt; Pages -&gt; Deploy from a branch -&gt; main -&gt; Save</li>
<li>Settings -&gt; Pages -&gt; Enforce HTTPS</li>
</ul>
<div class="border-bottom"></div><br>
<h4 id="專案亮點">專案亮點</h4>
<ul>
<li>有別於坊間範例所使用 gapminder 資料集（精簡版僅涵蓋 1952-2007，五年為時間間隔），這個專案從 gapminder.org 取得詳細資料集。</li>
<li>建立了檢視表關聯多個原始資料集。</li>
<li>以 matplotlib 進行概念驗證。</li>
<li>以 plotly.express 做出成品。</li>
<li>成品能夠以 GitHub Page 網址直接訪問。</li>
<li>可以重現（Reproducible）。</li>
</ul>
<div class="border-bottom"></div><br>
        </div>

        
        
      </div>
    </div>
  </div>
</section>





<script>
  var indexURL = "http://localhost:1313/index.json"
</script>

<!-- JS Plugins -->

<script src="http://localhost:1313/plugins/jQuery/jquery.min.js"></script>

<script src="http://localhost:1313/plugins/bootstrap/bootstrap.min.js"></script>

<script src="http://localhost:1313/plugins/slick/slick.min.js"></script>

<script src="http://localhost:1313/plugins/venobox/venobox.min.js"></script>

<script src="http://localhost:1313/plugins/search/fuse.min.js"></script>

<script src="http://localhost:1313/plugins/search/mark.js"></script>

<script src="http://localhost:1313/plugins/search/search.js"></script>

<!-- Main Script -->

<script src="http://localhost:1313/js/script.min.js"></script>



</body>
</html>